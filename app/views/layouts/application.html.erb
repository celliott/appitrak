<!DOCTYPE html>
<html>
<head>
  <title>habitrak</title>
  <%= stylesheet_link_tag    "application" %>
  <%= javascript_include_tag "application" %>
  
  <% if mobile_device? %>
    <%= stylesheet_link_tag 'mobile' %>
    <%= javascript_include_tag "bubble" %>
    <%= javascript_include_tag "bookmark_bubble" if params[:action] == "entry" %>
  <% elsif mobile_device_ipad? %>
    <%= javascript_include_tag "bubble" %>
    <%= javascript_include_tag "bookmark_bubble_ipad" if params[:action] == "entry" %>
  <% end %>

  <%= csrf_meta_tags %>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />  
  <meta name="viewport" id="vp" content="initial-scale=.75,user-scalable=no,maximum-scale=1" media="(device-height: 568px)" />
  <link rel="apple-touch-icon-precomposed" href="/images/habit_icon.png"/>
  <link rel="shortcut icon" href="/favicon.ico"/>
</head>
<body>

<%= link_to(root_url) do%>
<div class="header"><p>habitrak</p></div>
<% end %>
<% if @show_menu %>
	<div class="main menu main_menu">	
		<ul>
	    <li class="<%= "selected" if params[:action] == "entry" %>"><%= link_to("habits", root_url) %></li><li>&nbsp;&nbsp;|&nbsp;</li>
	    <li class="<%= "selected" if params[:action] == "trends" %>"><%= link_to("trends", :controller => 'trends') %></li>
	  </ul> 
	</div>
	
  <div id="user_menu">
    <p>welcome, <%= @user.first_name.downcase %>!</p>
      <div id="user_drop" class="not_open">  
        <ul>
          <li class="<%= "selected" if params[:controller] == "settings" || params[:controller] == "users" %>"><%= link_to("user settings", :controller => 'settings') %></li>
          <li><%= link_to("logout", :controller => 'logout') %></li>
        </ul>  
      </div>
  </div>
	
<% end %>

<% if @show_public_menu %>
	<div class="main menu">
	  <ul>
	      <li class="<%= "selected" if params[:action] == "login" %>"><%= link_to("login", :controller => 'login') %></li><li>&nbsp;&nbsp;|&nbsp;</li>
	      <li class="<%= "selected" if params[:action] == "new" || params[:action] == "create" %>"><%= link_to("sign up", :controller => 'signup') %></li>	        
	  </ul> 
	</div>
<% end %>

	<div id="flashContainer">
		<div style="display: none;" id="flashMessage">
		  <% if flash[:notice] %>
		      <p class="notice hide"><%= flash[:notice] %></p>
		    <% end %>
		  <% if flash[:error] %>
		      <p class="error hide"><%= flash[:error] %></p>
		  <% end %>
		  <% if flash[:alert] %>
		      <p class="alert hide"><%= flash[:alert] %></p>
		  <% end %>
		</div>
	</div>
<% if params[:action] == "login" && !mobile_device? || params[:action] == "login" && !mobile_device? || params[:action] == "create" && !mobile_device? || params[:action] == "entry" && !mobile_device? || params[:controller] == "settings" && !mobile_device? || params[:controller] == "users" && !mobile_device? %>
	<div class="container_narrow">
<% else %>	
	<div class="container">

<% end %>
	
	  <%= yield %>
	</div>

<%= render :partial => 'layouts/footer' %>

</body>
</html>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40050702-1', 'habitrak.com');
  ga('send', 'pageview');

</script>
